import{q as U,I as O,ac as u,a_ as fe,cz as z,o as b,j as T,a4 as P,a2 as Fe,bZ as Te,a as H,b$ as Oe,a3 as ne,c as D,cm as ce,k as G,w as k,B as le,cA as ie,cB as oe,d as C,aS as pe,b as h,aj as De,s as V,r as I,cj as _e,a9 as ge,u as x,m as A,br as ve,c5 as ye,c6 as ke,b5 as be,_ as Z,ae as Be,af as je,cC as Ee,F as R,cD as X,cn as Ce,cE as xe,aF as Me,g as Le,cF as Ue,p as J,i as Q,aT as L,bM as se,t as ae,cl as Ne,e as ze,aY as Pe,cG as Ve,aZ as Ge,b6 as Re}from"./index.b0e1550a.js";import{C as He}from"./index.9a44580e.js";/* empty css               */import{i as qe}from"./index.13ccca11.js";import{_ as We}from"./index.1b1a7df7.js";import"./index.7dd997be.js";import{u as Ye}from"./index.6f0cc111.js";import{U as Xe}from"./UploadOutlined.8feb67ab.js";import{M as Ze}from"./MenuOutlined.1133a30b.js";import{D as Ie}from"./DeleteOutlined.e5f00379.js";import{_ as Je,a as Qe}from"./index.e41e4f00.js";import{D as Ke}from"./DownloadOutlined.b6ed2567.js";import{E as et}from"./EditOutlined.d7071bee.js";import"./index.d4371571.js";import{S as tt}from"./Spin.83ba1358.js";import"./css.1dd79e5e.js";import"./ZoomOutOutlined.19b0b6ba.js";const re=U({name:"FileGridItem",props:{item:{type:Object,required:!0},checkbox:Boolean,selection:Array,icons:Array},emits:["item-click","item-check-change"],setup(e,{emit:t,slots:l}){const r=O(()=>e.item&&Array.isArray(e.selection)&&e.selection.includes(e.item)),a=O(()=>{var _,d,i;if(e.item.thumbnail)return e.item.thumbnail;if(!!e.icons)return e.item.isDirectory?(_=e.icons.find(s=>s.type==="dir"))==null?void 0:_.icon:((d=e.icons.find(s=>{var m;return!!((m=s.types)!=null&&m.find(y=>{var n;return!!((n=e.item.name)!=null&&n.endsWith(y))}))}))==null?void 0:d.icon)||((i=e.icons.find(s=>s.type==="file"))==null?void 0:i.icon)}),f=()=>{t("item-click",e.item)},v=()=>{t("item-check-change",e.item)};return()=>{const _=l["context-menu"],d=[],i=u("div",{class:"ele-file-list-item-body"},[u("div",{class:"ele-file-list-item-icon"},[u("img",{src:a.value,class:{"ele-file-list-item-icon-image":!!e.item.thumbnail}})]),u("div",{class:"ele-file-list-item-title",title:e.item.name},e.item.name)]);return _?d.push(u(fe,{trigger:["contextmenu"],overlayClassName:"ele-file-item-context-menu"},{default:()=>[i],overlay:()=>_({item:e.item})})):d.push(i),e.checkbox&&d.push(u("div",{class:"ele-file-list-item-check",onClick:z(v,["stop"])},[u("i",{class:"ele-file-icon-check checked"})])),u("div",{class:["ele-file-list-item",{checked:r.value}],onClick:z(f,["stop"])},d)}}}),nt=U({name:"FileGrid",components:{FileGridItem:re},props:{data:Array,icons:Array,selection:Array,checkbox:Boolean,checked:Boolean,indeterminate:Boolean,total:Number,totalText:String,checkAllText:String},emits:["check-all-change","item-click","item-check-change"],setup(e,{emit:t,slots:l}){const r=O(()=>["ele-file-list-check ele-file-icon-check",{checked:e.checked},{indeterminate:e.indeterminate}]),a=()=>{t("check-all-change")},f=_=>{t("item-click",_)},v=_=>{t("item-check-change",_)};return()=>{var _,d;const i=[];return e.checkbox&&i.push(u("div",{class:"ele-file-list-header"},[u("div",{class:"ele-file-list-check-group",onClick:z(a,["stop"])},[u("i",{class:r.value}),u("div",{},e.total?(_=e.totalText)==null?void 0:_.replace(/{total}/g,String(e.total)):e.checkAllText)])])),i.push(u("div",{class:"ele-file-list-body"},(d=e.data)==null?void 0:d.map((s,m)=>u(re,{key:m,item:s,icons:e.icons,checkbox:e.checkbox,selection:e.selection,"onItem-click":f,"onItem-check-change":v},l)))),u("div",{class:"ele-file-list"},i)}}}),ct=U({name:"FileSort",props:{sort:String,order:String,name:{type:String,required:!0}},setup(e){return{classes:O(()=>["ele-file-list-table-item-sort",{"ele-file-list-sort-asc":e.name===e.sort&&e.order==="asc"},{"ele-file-list-sort-desc":e.name===e.sort&&e.order==="desc"}])}}}),lt=(e,t)=>{const l=e.__vccOpts||e;for(const[r,a]of t)l[r]=a;return l};function it(e,t,l,r,a,f){return b(),T("i",{class:P(e.classes)},null,2)}const Y=lt(ct,[["render",it]]),de=U({name:"FileTableItem",props:{item:{type:Object,required:!0},checkbox:Boolean,selection:Array,icons:Array,columns:Array},emits:["item-click","item-check-change"],setup(e,{emit:t,slots:l}){const r=O(()=>e.item&&Array.isArray(e.selection)&&e.selection.includes(e.item)),a=O(()=>{var _,d,i;if(!!e.icons)return e.item.isDirectory?(_=e.icons.find(s=>s.type==="dir"))==null?void 0:_.icon:((d=e.icons.find(s=>{var m;return!!((m=s.types)!=null&&m.find(y=>{var n;return!!((n=e.item.name)!=null&&n.endsWith(y))}))}))==null?void 0:d.icon)||((i=e.icons.find(s=>s.type==="file"))==null?void 0:i.icon)}),f=()=>{t("item-click",e.item)},v=()=>{t("item-check-change",e.item)};return()=>{var _;const d=l["context-menu"],i=[];e.checkbox&&i.push(u("div",{class:"ele-file-list-table-item-check-group"},[u("i",{class:["ele-file-icon-check",{checked:r.value}],onClick:z(v,["stop"])})]));const s=[u("div",{class:"ele-file-list-table-item-icon"},[u("img",{src:a.value,alt:e.item.name,class:"ele-file-list-table-item-icon-image",onClick:f}),u("div",{class:"ele-file-list-table-item-title",title:e.item.name,onClick:f},e.item.name)])],m=l.tool;m&&s.push(u("div",{class:"ele-file-list-table-item-tool-group"},m({item:e.item}))),i.push(u("div",{class:"ele-file-list-table-item-name"},s)),(_=e.columns)==null||_.forEach(n=>{var p;const o=(p=e.item)==null?void 0:p[n.prop],c=n.slot?l[n.slot]:void 0;i.push(u("div",{key:n.prop,style:n.style,class:"ele-file-list-table-item-col"},c?c({item:e.item,col:n}):o==null?void 0:String(o)))});const y=u("div",{class:"ele-file-list-table-item-body"},i);return u("div",{class:["ele-file-list-table-item",{checked:r.value}]},[d?u(fe,{trigger:["contextmenu"],overlayClassName:"ele-file-item-context-menu"},{default:()=>[y],overlay:()=>d({item:e.item})}):y])}}}),ot=U({name:"FileTable",components:{FileSort:Y,FileTableItem:de},props:{data:Array,icons:Array,selection:Array,checkbox:Boolean,checked:Boolean,indeterminate:Boolean,total:Number,totalText:String,checkAllText:String,nameText:String,sizeText:String,timeText:String,sort:{type:[String,Boolean],default:!1},order:String,columns:Array},emits:["check-all-change","item-click","item-check-change","sort-change"],setup(e,{emit:t,slots:l}){const r=O(()=>["ele-file-list-table-item-check ele-file-icon-check",{checked:e.checked},{indeterminate:e.indeterminate}]),a=O(()=>e.columns?e.columns:[{title:e.sizeText,prop:"length",style:{width:"120px",flexShrink:0}},{title:e.timeText,prop:"updateTime",style:{width:"180px",flexShrink:0}}]),f=()=>{t("check-all-change")},v=i=>{t("item-click",i)},_=i=>{t("item-check-change",i)},d=i=>{t("sort-change",i)};return()=>{var i;const s=[],m=[];if(e.checkbox){m.push(u("div",{class:"ele-file-list-table-item-check-group"},[u("i",{class:r.value,onClick:z(f,["stop"])})]));const y=[u("span",{},e.nameText)];typeof e.sort=="string"&&y.push(u(Y,{sort:e.sort,order:e.order,name:"name"})),m.push(u("div",{class:"ele-file-list-table-item-name",onClick:()=>d("name")},y)),a.value.forEach(n=>{const p=n.headerSlot?l[n.headerSlot]:void 0,o=[u("span",{},p?p({col:n}):n.title)];typeof e.sort=="string"&&o.push(u(Y,{sort:e.sort,order:e.order,name:n.prop})),m.push(u("div",{key:n.prop,style:n.headStyle||n.style,class:"ele-file-list-table-item-col",onClick:()=>d(n.prop)},o))})}return s.push(u("div",{class:"ele-file-list-table-header"},[u("div",{class:"ele-file-list-table-item"},[u("div",{class:"ele-file-list-table-item-body"},[m])])])),s.push(u("div",{class:"ele-file-list-table-body"},(i=e.data)==null?void 0:i.map((y,n)=>u(de,{key:n,item:y,icons:e.icons,checkbox:e.checkbox,selection:e.selection,columns:a.value,"onItem-click":v,"onItem-check-change":_},l)))),u("div",{class:"ele-file-list-table"},s)}}}),st=[{icon:"https://cdn.eleadmin.com/20200609/ic_file_misc.png",type:"file"},{icon:"https://cdn.eleadmin.com/20200609/ic_file_folder.png",type:"dir"},{icon:"https://cdn.eleadmin.com/20200609/ic_file_code.png",types:[".java",".js",".css",".vue",".ts",".tsx",".scss",".less",".c",".cpp",".cs",".jsp",".php",".asp",".py",".go",".kt",".lua"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_htm.png",types:[".html",".htm"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_text.png",types:[".txt"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_pdf.png",types:[".pdf"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_word.png",types:[".doc",".docx"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_excel.png",types:[".xls",".xlsx"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_ppt.png",types:[".ppt",".pptx"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_visio.png",types:[".vsd"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_ps.png",types:[".psd"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_cad.png",types:[".dwg"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_flash.png",types:[".swf"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_music.png",types:[".mp3",".wav"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_video.png",types:[".mp4",".rmvb",".flv",".avi",".3gp"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_picture.png",types:[".png",".jpg",".jpeg",".gif",".bmp"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_fonts.png",types:[".ttf",".woff"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_bt.png",types:[".torrent"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_android.png",types:[".apk"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_exe.png",types:[".exe"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_ipa.png",types:[".ipa",".dmg"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_zip.png",types:[".zip",".rar",".7z"]}],at=[{icon:"https://cdn.eleadmin.com/20200609/ic_file_misc_sm.png",type:"file"},{icon:"https://cdn.eleadmin.com/20200609/ic_file_folder_sm.png",type:"dir"},{icon:"https://cdn.eleadmin.com/20200609/ic_file_code_sm.png",types:[".java",".js",".css",".vue",".ts",".tsx",".scss",".less",".c",".cpp",".cs",".jsp",".php",".asp",".py",".go",".kt",".lua"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_htm_sm.png",types:[".html",".htm"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_text_sm.png",types:[".txt"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_pdf_sm.png",types:[".pdf"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_word_sm.png",types:[".doc",".docx"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_excel_sm.png",types:[".xls",".xlsx"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_ppt_sm.png",types:[".ppt",".pptx"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_visio_sm.png",types:[".vsd"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_ps_sm.png",types:[".psd"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_cad_sm.png",types:[".dwg"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_flash_sm.png",types:[".swf"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_music_sm.png",types:[".mp3",".wav"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_video_sm.png",types:[".mp4",".rmvb",".flv",".avi",".3gp"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_picture_sm.png",types:[".png",".jpg",".jpeg",".gif",".bmp"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_fonts_sm.png",types:[".ttf",".woff"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_bt_sm.png",types:[".torrent"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_android_sm.png",types:[".apk"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_exe_sm.png",types:[".exe"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_ipa_sm.png",types:[".ipa",".dmg"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_zip_sm.png",types:[".zip",".rar",".7z"]}],rt={data:{type:Array,required:!0},checked:Array,grid:{type:Boolean,default:!0},sort:{type:[String,Boolean],default:!1},order:String,icons:{type:Array,default:()=>st},smIcons:{type:Array,default:()=>at},columns:Array},me=".ele-file-list-body>.ele-file-list-item",ue=".ele-file-list-table-body>.ele-file-list-table-item",dt=U({name:"EleFileList",components:{FileGrid:nt,FileTable:ot},props:rt,emits:["item-click","sort-change","update:checked"],setup(e,{emit:t}){const{authenticated:l}=Fe(),{locale:r}=Te({name:"fileList"}),a=H({left:"0px",top:"0px",width:"0px",height:"0px",display:"none"}),f=O(()=>Array.isArray(e.checked)),v=O(()=>{var n,p,o;return!!((n=e.data)!=null&&n.length)&&((p=e.checked)==null?void 0:p.length)===((o=e.data)==null?void 0:o.length)}),_=O(()=>{var n,p;return!!(((n=e.checked)==null?void 0:n.length)&&e.checked.length!==((p=e.data)==null?void 0:p.length))});return{locale:r,selectorStyle:a,checkbox:f,allChecked:v,indeterminate:_,checkAllChange:()=>{v.value||e.data==null||!e.data.length?t("update:checked",[]):t("update:checked",e.data.slice())},itemCheckChange:n=>{var p,o,c,g;const w=(o=(p=e.checked)==null?void 0:p.indexOf(n))!=null?o:-1;if(w===-1)t("update:checked",(c=e.checked)==null?void 0:c.concat([n]));else{const $=(g=e.checked)==null?void 0:g.slice(0,w).concat(e.checked.slice(w+1,e.checked.length));t("update:checked",$)}},onItemClick:n=>{if(!l.value){console.warn(Oe);return}t("item-click",n)},onSortChange:n=>{typeof e.sort=="string"&&t("sort-change",{sort:n,order:e.order&&n===e.sort?{asc:"desc",desc:""}[e.order]:"asc"})},onMousedown:n=>{if(!f.value)return;const p=n.clientX,o=n.clientY,c=n.currentTarget,g=c.getBoundingClientRect(),w=S=>{const M=Math.max(S.clientX,g.left),E=Math.max(S.clientY,g.top),j=Math.min(M,p)-g.left,F=Math.min(E,o)-g.top,N=Math.min(Math.abs(M-p),c.clientWidth-j),W=Math.min(Math.abs(E-o),c.clientHeight-F),Se={left:j+"px",top:F+"px",width:N+"px",height:W+"px",display:"block"};Object.assign(a,Se);const te=c.querySelectorAll(e.grid?me:ue);if(N<6||W<6){Array.from(te).forEach(B=>{B.classList.remove("active")});return}n.stopPropagation(),n.preventDefault(),S.stopPropagation(),S.preventDefault(),Array.from(te).forEach(B=>{const Ae=B.offsetLeft+B.clientWidth,$e=B.offsetTop+B.clientHeight;Ae>j&&$e>F&&B.offsetLeft<j+N&&B.offsetTop<F+W?B.classList.add("active"):B.classList.remove("active")})},$=()=>{a.display="none";const S=[],M=c.querySelectorAll(e.grid?me:ue);Array.from(M).forEach((E,j)=>{E.classList.contains("active")&&(E.classList.remove("active"),e.data&&e.data[j]&&S.push(e.data[j]))}),S.length&&t("update:checked",S),document.removeEventListener("mousemove",w),document.removeEventListener("mouseup",$)};document.addEventListener("mousemove",w),document.addEventListener("mouseup",$)}}}}),mt=(e,t)=>{const l=e.__vccOpts||e;for(const[r,a]of t)l[r]=a;return l};function ut(e,t,l,r,a,f){const v=ne("FileGrid"),_=ne("FileTable");return b(),T("div",{class:"ele-file-list-group",onMousedown:t[0]||(t[0]=(...d)=>e.onMousedown&&e.onMousedown(...d))},[e.grid?(b(),D(v,{key:0,data:e.data,icons:e.icons,selection:e.checked,checkbox:e.checkbox,checked:e.allChecked,indeterminate:e.indeterminate,total:e.checked?e.checked.length:0,"total-text":e.locale.selectTips,"check-all-text":e.locale.selectAll,onCheckAllChange:e.checkAllChange,onItemClick:e.onItemClick,onItemCheckChange:e.itemCheckChange},ce({_:2},[G(Object.keys(e.$slots),d=>({name:d,fn:k(i=>[le(e.$slots,d,ie(oe(i||{})))])}))]),1032,["data","icons","selection","checkbox","checked","indeterminate","total","total-text","check-all-text","onCheckAllChange","onItemClick","onItemCheckChange"])):(b(),D(_,{key:1,data:e.data,icons:e.icons,selection:e.checked,checkbox:e.checkbox,checked:e.allChecked,indeterminate:e.indeterminate,total:e.checked?e.checked.length:0,"total-text":e.locale.selectTips,"check-all-text":e.locale.selectAll,"name-text":e.locale.fileName,"size-text":e.locale.fileSize,"time-text":e.locale.fileTimestamp,sort:e.sort,order:e.order,columns:e.columns,onCheckAllChange:e.checkAllChange,onItemClick:e.onItemClick,onItemCheckChange:e.itemCheckChange,onSortChange:e.onSortChange},ce({_:2},[G(Object.keys(e.$slots),d=>({name:d,fn:k(i=>[le(e.$slots,d,ie(oe(i||{})))])}))]),1032,["data","icons","selection","checkbox","checked","indeterminate","total","total-text","check-all-text","name-text","size-text","time-text","sort","order","columns","onCheckAllChange","onItemClick","onItemCheckChange","onSortChange"])),C("div",{class:"ele-file-list-selector",style:pe(e.selectorStyle)},null,4)],32)}const ht=mt(dt,[["render",ut]]);var ft={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M484 443.1V528h-84.5c-4.1 0-7.5 3.1-7.5 7v42c0 3.8 3.4 7 7.5 7H484v84.9c0 3.9 3.2 7.1 7 7.1h42c3.9 0 7-3.2 7-7.1V584h84.5c4.1 0 7.5-3.2 7.5-7v-42c0-3.9-3.4-7-7.5-7H540v-84.9c0-3.9-3.1-7.1-7-7.1h-42c-3.8 0-7 3.2-7 7.1zm396-144.7H521L403.7 186.2a8.15 8.15 0 00-5.5-2.2H144c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V330.4c0-17.7-14.3-32-32-32zM840 768H184V256h188.5l119.6 114.4H840V768z"}}]},name:"folder-add",theme:"outlined"};const pt=ft;function he(e){for(var t=1;t<arguments.length;t++){var l=arguments[t]!=null?Object(arguments[t]):{},r=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(l).filter(function(a){return Object.getOwnPropertyDescriptor(l,a).enumerable}))),r.forEach(function(a){_t(e,a,l[a])})}return e}function _t(e,t,l){return t in e?Object.defineProperty(e,t,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[t]=l,e}var K=function(t,l){var r=he({},t,l.attrs);return h(De,he({},r,{icon:pt}),null)};K.displayName="FolderAddOutlined";K.inheritAttrs=!1;const gt=K;async function vt(e){const t=await V.get("/system/user-file",{params:e});return t.data.code===0&&t.data.data?t.data.data:Promise.reject(new Error(t.data.message))}async function we(e){const t=await V.post("/system/user-file",e);return t.data.code===0?t.data.message:Promise.reject(new Error(t.data.message))}async function yt(e){const t=await V.put("/system/user-file",e);return t.data.code===0?t.data.message:Promise.reject(new Error(t.data.message))}async function kt(e){const t=await V.delete("/system/user-file/"+e);return t.data.code===0?t.data.message:Promise.reject(new Error(t.data.message))}async function bt(e){const t=await V.delete("/system/user-file/batch",{data:e});return t.data.code===0?t.data.message:Promise.reject(new Error(t.data.message))}const Ct={__name:"folder-add",props:{visible:Boolean,parentId:Number},emits:["done","update:visible"],setup(e,{emit:t}){const l=e,r=I(null),a=I(!1),{form:f,resetFields:v}=_e({name:""}),_=H({name:[{required:!0,message:"\u8BF7\u8F93\u5165\u6587\u4EF6\u5939\u540D\u79F0",type:"string",trigger:"blur"}]}),d=()=>{!r.value||r.value.validate().then(()=>{a.value=!0,we({...f,parentId:l.parentId,isDirectory:1}).then(s=>{a.value=!1,A.success(s),i(!1),t("done")}).catch(s=>{a.value=!1,A.error(s.message)})}).catch(()=>{})},i=s=>{t("update:visible",s)};return ge(()=>l.visible,s=>{var m;s||(v(),(m=r.value)==null||m.clearValidate())}),(s,m)=>{const y=ve,n=ye,p=ke,o=be;return b(),D(o,{width:460,visible:e.visible,"confirm-loading":a.value,title:"\u65B0\u5EFA\u6587\u4EF6\u5939","body-style":{paddingBottom:"8px"},"onUpdate:visible":i,onOk:d},{default:k(()=>[h(p,{ref_key:"formRef",ref:r,model:x(f),rules:_,"label-col":{md:6,sm:6,xs:24},"wrapper-col":{md:18,sm:18,xs:24}},{default:k(()=>[h(n,{label:"\u6587\u4EF6\u5939\u540D\u79F0",name:"name"},{default:k(()=>[h(y,{"allow-clear":"",maxlength:20,placeholder:"\u8BF7\u8F93\u5165\u6587\u4EF6\u5939\u540D\u79F0",value:x(f).name,"onUpdate:value":m[0]||(m[0]=c=>x(f).name=c)},null,8,["value"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["visible","confirm-loading"])}}};const ee=e=>(J("data-v-507585d6"),e=e(),Q(),e),xt=ee(()=>C("span",null,"\u4E0A\u4F20",-1)),It=ee(()=>C("span",null,"\u65B0\u5EFA\u6587\u4EF6\u5939",-1)),wt=ee(()=>C("span",null,"\u5220\u9664",-1)),St={__name:"file-toolbar",props:{grid:Boolean,checked:Array,parentId:Number},emits:["update:grid","done"],setup(e,{emit:t}){const l=e,r=Be(),{styleResponsive:a}=je(r),f=I(""),v=I(!1),_=({file:y})=>{if(y.size/1024/1024>100)return A.error("\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7 100MB"),!1;const n=X("\u4E0A\u4F20\u4E2D..",0);return Ye(y).then(p=>{we({name:p.name,isDirectory:0,parentId:l.parentId,path:p.path,length:p.length,contentType:p.contentType}).then(()=>{n(),A.success("\u4E0A\u4F20\u6210\u529F"),s()}).catch(o=>{n(),A.error(o.message)})}).catch(p=>{n(),A.error(p.message)}),!1},d=()=>{v.value=!0},i=()=>{Ce.confirm({title:"\u63D0\u793A",content:"\u786E\u5B9A\u8981\u5220\u9664\u9009\u4E2D\u7684\u6587\u4EF6\u5417?",icon:h(xe),maskClosable:!0,onOk:()=>{const y=X("\u8BF7\u6C42\u4E2D..",0);bt(l.checked.map(n=>n.id)).then(n=>{y(),A.success(n),s()}).catch(n=>{y(),A.error(n.message)})}})},s=()=>{t("done")},m=()=>{t("update:grid",!l.grid)};return(y,n)=>{const p=Me,o=We,c=Le,g=Ue,w=qe;return b(),T(R,null,[h(w,null,{action:k(()=>[C("div",{style:{"max-width":"240px"},class:P({"hidden-sm-and-down":x(a)})},[h(g,{value:f.value,"onUpdate:value":n[0]||(n[0]=$=>f.value=$),placeholder:"\u641C\u7D22\u60A8\u7684\u6587\u4EF6"},null,8,["value"])],2),e.grid?(b(),D(x(Ze),{key:0,class:"ele-file-tool-btn",onClick:m})):(b(),D(x(Ee),{key:1,class:"ele-file-tool-btn",onClick:m}))]),default:k(()=>[h(c,null,{default:k(()=>[h(o,{"show-upload-list":!1,customRequest:_},{default:k(()=>[h(p,{type:"primary",class:"ele-btn-icon"},{icon:k(()=>[h(x(Xe))]),default:k(()=>[xt]),_:1})]),_:1}),h(p,{type:"dashed",class:"ele-btn-icon",onClick:d},{icon:k(()=>[h(x(gt))]),default:k(()=>[It]),_:1}),h(p,{danger:"",type:"dashed",disabled:!e.checked.length,class:P(["ele-btn-icon",{"hidden-xs-only":x(a)}]),onClick:i},{icon:k(()=>[h(x(Ie))]),default:k(()=>[wt]),_:1},8,["disabled","class"])]),_:1})]),_:1}),h(Ct,{visible:v.value,"onUpdate:visible":n[1]||(n[1]=$=>v.value=$),"parent-id":e.parentId,onDone:s},null,8,["visible","parent-id"])],64)}}},At=Z(St,[["__scopeId","data-v-507585d6"]]);const $t=e=>(J("data-v-187a0720"),e=e(),Q(),e),Ft={class:"ele-file-breadcrumb-group ele-cell"},Tt={class:"ele-cell-content ele-cell"},Ot={class:"ele-file-breadcrumb-list ele-cell-content ele-cell"},Dt=$t(()=>C("div",{class:"ele-file-breadcrumb-item-title"},"\u5168\u90E8\u6587\u4EF6",-1)),Bt=["onClick"],jt={class:"ele-file-breadcrumb-item-title"},Et={class:"hidden-xs-only"},Mt={__name:"file-header",props:{directorys:Array,total:Number},emits:["update:directorys"],setup(e,{emit:t}){const l=e,r=()=>{t("update:directorys",l.directorys.slice(0,l.directorys.length-1))},a=()=>{l.directorys.length&&t("update:directorys",[])},f=v=>{v!==l.directorys.length-1&&t("update:directorys",l.directorys.slice(0,v+1))};return(v,_)=>(b(),T("div",Ft,[C("div",Tt,[e.directorys.length?(b(),T("div",{key:0,class:"ele-file-breadcrumb-back ele-text-primary",onClick:r}," \u8FD4\u56DE\u4E0A\u4E00\u7EA7 ")):L("",!0),C("div",Ot,[C("div",{class:P(["ele-file-breadcrumb-item ele-cell",{"ele-text-primary":!!e.directorys.length}]),onClick:a},[Dt,e.directorys.length?(b(),D(x(se),{key:0,class:"ele-text-secondary"})):L("",!0)],2),(b(!0),T(R,null,G(e.directorys,(d,i)=>(b(),T("div",{key:d.id,class:P(["ele-file-breadcrumb-item ele-cell",{"ele-text-primary":i!==e.directorys.length-1}]),onClick:s=>f(i)},[C("div",jt,ae(d.name),1),i!==e.directorys.length-1?(b(),D(x(se),{key:0,class:"ele-text-secondary"})):L("",!0)],10,Bt))),128))])]),C("div",Et,"\u5DF2\u5168\u90E8\u52A0\u8F7D\uFF0C\u5171 "+ae(e.total)+" \u4E2A",1)]))}},Lt=Z(Mt,[["__scopeId","data-v-187a0720"]]);const Ut={__name:"name-edit",props:{visible:Boolean,data:Object},emits:["done","update:visible"],setup(e,{emit:t}){const l=e,r=I(null),a=I(!1),{form:f,resetFields:v}=_e({name:""}),_=H({name:[{required:!0,message:"\u8BF7\u8F93\u5165\u6587\u4EF6/\u5939\u540D\u79F0",type:"string",trigger:"blur"}]}),d=()=>{!r.value||r.value.validate().then(()=>{var s;a.value=!0,yt({...f,id:(s=l.data)==null?void 0:s.id}).then(m=>{a.value=!1,A.success(m),i(!1),t("done")}).catch(m=>{a.value=!1,A.error(m.message)})}).catch(()=>{})},i=s=>{t("update:visible",s)};return ge(()=>l.visible,s=>{var m;s?l.data&&(f.name=l.data.name):(v(),(m=r.value)==null||m.clearValidate())}),(s,m)=>{const y=ve,n=ye,p=ke,o=be;return b(),D(o,{width:460,visible:e.visible,"confirm-loading":a.value,title:"\u91CD\u547D\u540D","body-style":{paddingBottom:"8px"},"onUpdate:visible":i,onOk:d},{default:k(()=>[h(p,{ref_key:"formRef",ref:r,model:x(f),rules:_,"label-col":{md:6,sm:6,xs:24},"wrapper-col":{md:18,sm:18,xs:24}},{default:k(()=>[h(n,{label:"\u6587\u4EF6/\u5939\u540D\u79F0",name:"name"},{default:k(()=>[h(y,{"allow-clear":"",maxlength:20,placeholder:"\u8BF7\u8F93\u5165\u6587\u4EF6/\u5939\u540D\u79F0",value:x(f).name,"onUpdate:value":m[0]||(m[0]=c=>x(f).name=c)},null,8,["value"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["visible","confirm-loading"])}}};const q=e=>(J("data-v-c4522903"),e=e(),Q(),e),Nt={class:"demo-file-list-group"},zt=ze("\u6253\u5F00"),Pt={class:"ele-cell"},Vt=q(()=>C("div",{class:"ele-cell-content"},"\u4E0B\u8F7D",-1)),Gt={class:"ele-cell"},Rt=q(()=>C("div",{class:"ele-cell-content"},"\u91CD\u547D\u540D",-1)),Ht={class:"ele-cell"},qt=q(()=>C("div",{class:"ele-cell-content"},"\u79FB\u52A8\u5230",-1)),Wt={class:"ele-cell ele-text-danger"},Yt=q(()=>C("div",{class:"ele-cell-content"},"\u5220\u9664",-1)),Xt={key:0,class:"demo-file-list-empty"},Zt={style:{display:"none"}},Jt={__name:"file-list",props:{parentId:Number,data:Array,sort:String,order:String,checked:Array,grid:Boolean},emits:["sort-change","update:checked","go-directory","done"],setup(e,{emit:t}){const l=e,r=H({current:0,visible:!1,onVisibleChange:o=>{r.visible=o}}),a=I([]),f=I(!1),v=I(),_=o=>{t("sort-change",o)},d=o=>{t("update:checked",o)},i=o=>{o.isDirectory?t("go-directory",o):n(o)?p(o):d(l.checked.includes(o)?l.checked.filter(c=>c!==o):[...l.checked,o])},s=(o,c)=>{o==="open"?c.isDirectory||n(c)?i(c):window.open(c.url):o==="download"?typeof c.downloadUrl=="string"&&window.open(c.downloadUrl):o==="edit"?(v.value=c,f.value=!0):o==="remove"&&m(c)},m=o=>{Ce.confirm({title:"\u63D0\u793A",content:"\u786E\u5B9A\u8981\u5220\u9664\u6B64\u6587\u4EF6\u5417?",icon:h(xe),maskClosable:!0,onOk:()=>{const c=X("\u8BF7\u6C42\u4E2D..",0);kt(o.id).then(g=>{c(),A.success(g),y()}).catch(g=>{c(),A.error(g.message)})}})},y=()=>{t("done")},n=o=>typeof o.contentType=="string"&&o.contentType.startsWith("image/")&&o.url,p=o=>{a.value=l.data.filter(g=>n(g));const c=a.value.indexOf(o);c!==-1&&(r.current=c,r.visible=!0)};return(o,c)=>{const g=Pe,w=Ve,$=Ge,S=ht,M=Re,E=Je,j=Qe;return b(),T(R,null,[C("div",Nt,[h(S,{data:e.data,grid:e.grid,sort:e.sort,order:e.order,checked:e.checked,style:pe({minHeight:"400px",minWidth:e.grid?"auto":"456px"}),onItemClick:i,onSortChange:_,"onUpdate:checked":d},{"context-menu":k(({item:F})=>[h($,{selectable:!1,onClick:({key:N})=>s(N,F)},{default:k(()=>[h(g,{key:"open"},{default:k(()=>[zt]),_:1}),h(w),F.isDirectory?L("",!0):(b(),D(g,{key:"download"},{default:k(()=>[C("div",Pt,[h(x(Ke)),Vt])]),_:1})),h(g,{key:"edit"},{default:k(()=>[C("div",Gt,[h(x(et)),Rt])]),_:1}),h(g,{key:"move"},{default:k(()=>[C("div",Ht,[h(x(Ne)),qt])]),_:1}),h(w),h(g,{key:"remove"},{default:k(()=>[C("div",Wt,[h(x(Ie)),Yt])]),_:1})]),_:2},1032,["onClick"])]),_:1},8,["data","grid","sort","order","checked","style"]),e.data.length?L("",!0):(b(),T("div",Xt,[h(M)]))]),C("div",Zt,[r.visible?(b(),D(j,{key:0,preview:r},{default:k(()=>[(b(!0),T(R,null,G(a.value,F=>(b(),D(E,{key:String(F.id),src:F.url},null,8,["src"]))),128))]),_:1},8,["preview"])):L("",!0)]),h(Ut,{visible:f.value,"onUpdate:visible":c[0]||(c[0]=F=>f.value=F),data:v.value,onDone:y},null,8,["visible","data"])],64)}}},Qt=Z(Jt,[["__scopeId","data-v-c4522903"]]),Kt={class:"ele-body"},en={style:{padding:"16px 16px 12px 16px"}},tn={name:"ExtensionFile"},kn=Object.assign(tn,{setup(e){const t=I(!0),l=I([]),r=I(""),a=I(""),f=I([]),v=I([]),_=I(0),d=I(!0),i=I(0),s=()=>{l.value=[],f.value=[],t.value=!0,vt({sort:a.value?r.value:"",order:a.value,parentId:i.value}).then(c=>{t.value=!1,l.value=c.map(g=>Object.assign({name:g.name},g,{isDirectory:g.isDirectory===1,length:o(g.length)})),_.value=c.length}).catch(c=>{t.value=!1,A.error(c.message)})},m=()=>{s()},y=c=>{a.value=c.order,r.value=c.sort,s()},n=c=>{p([...v.value,c])},p=c=>{var g,w;v.value=c,i.value=(w=(g=v.value[v.value.length-1])==null?void 0:g.id)!=null?w:0,s()},o=c=>c==null?"-":c<1024?c+"B":c<1024*1024?(c/1024).toFixed(1)+"KB":c<1024*1024*1024?(c/1024/1024).toFixed(1)+"M":(c/1024/1024/1024).toFixed(1)+"G";return s(),(c,g)=>{const w=tt,$=He;return b(),T("div",Kt,[h($,{bordered:!1,"body-style":{padding:0}},{default:k(()=>[C("div",en,[h(At,{grid:d.value,"onUpdate:grid":g[0]||(g[0]=S=>d.value=S),checked:f.value,parentId:i.value,onDone:m},null,8,["grid","checked","parentId"]),h(Lt,{total:_.value,directorys:v.value,"onUpdate:directorys":p},null,8,["total","directorys"])]),h(w,{spinning:t.value},{default:k(()=>[h(Qt,{grid:d.value,data:l.value,sort:r.value,order:a.value,parentId:i.value,checked:f.value,"onUpdate:checked":g[1]||(g[1]=S=>f.value=S),onSortChange:y,onGoDirectory:n,onDone:m},null,8,["grid","data","sort","order","parentId","checked"])]),_:1},8,["spinning"])]),_:1})])}}});export{kn as default};
