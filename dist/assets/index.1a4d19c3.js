import{cj as M,o as k,c as S,w as a,b as o,u as i,cA as R,cB as $,e as B,br as O,c5 as V,aF as T,g as I,c6 as j,r as b,aP as E,j as C,t as P,d as x,aT as z,cD as w,m as l,cn as q,cE as A,h as G}from"./index.b0e1550a.js";import{_ as K,a as L,C as H}from"./index.9a44580e.js";/* empty css              *//* empty css              *//* empty css               *//* empty css               *//* empty css               */import"./index.13ccca11.js";import{i as J}from"./index.a402f9d8.js";import{_ as Q}from"./index.35429753.js";import{_ as W}from"./index.1b1a7df7.js";import"./index.7dd997be.js";import{p as X,r as Y,a as Z,u as ee}from"./index.6f0cc111.js";import{U as te}from"./UploadOutlined.8feb67ab.js";import{D as oe}from"./DeleteOutlined.e5f00379.js";import"./vuedraggable.umd.15cba163.js";import"./index.50a7696f.js";import"./css.1dd79e5e.js";import"./index.d4371571.js";import"./Spin.83ba1358.js";import"./index.79d1eddb.js";import"./useMaxLevel.2bdcb2e5.js";import"./Group.ef3b103e.js";import"./index.92aa3868.js";import"./RadioButton.4b1c6045.js";import"./CaretUpOutlined.0f21e912.js";import"./iconUtil.035bdc1b.js";import"./DownloadOutlined.b6ed2567.js";const ae=B("\u67E5\u8BE2"),se=B("\u91CD\u7F6E"),ne={__name:"file-search",emits:["search"],setup(N,{emit:c}){const{form:n,resetFields:m}=M({name:"",path:"",createNickname:""}),f=()=>{c("search",n)},_=()=>{m(),f()};return(F,r)=>{const p=O,e=V,t=K,s=T,d=I,h=L,y=j;return k(),S(y,{"label-col":{xl:7,lg:5,md:7,sm:4},"wrapper-col":{xl:17,lg:19,md:17,sm:20}},{default:a(()=>[o(h,{gutter:8},{default:a(()=>[o(t,{xl:6,lg:12,md:12,sm:24,xs:24},{default:a(()=>[o(e,{label:"\u6587\u4EF6\u540D\u79F0"},{default:a(()=>[o(p,{value:i(n).name,"onUpdate:value":r[0]||(r[0]=u=>i(n).name=u),valueModifiers:{trim:!0},placeholder:"\u8BF7\u8F93\u5165","allow-clear":""},null,8,["value"])]),_:1})]),_:1}),o(t,R($({xl:6,lg:12,md:12,sm:24,xs:24})),{default:a(()=>[o(e,{label:"\u6587\u4EF6\u8DEF\u5F84"},{default:a(()=>[o(p,{value:i(n).path,"onUpdate:value":r[1]||(r[1]=u=>i(n).path=u),valueModifiers:{trim:!0},placeholder:"\u8BF7\u8F93\u5165","allow-clear":""},null,8,["value"])]),_:1})]),_:1},16),o(t,{xl:6,lg:12,md:12,sm:24,xs:24},{default:a(()=>[o(e,{label:"\u4E0A\u4F20\u4EBA"},{default:a(()=>[o(p,{value:i(n).createNickname,"onUpdate:value":r[2]||(r[2]=u=>i(n).createNickname=u),valueModifiers:{trim:!0},placeholder:"\u8BF7\u8F93\u5165","allow-clear":""},null,8,["value"])]),_:1})]),_:1}),o(t,{xl:6,lg:12,md:12,sm:24,xs:24},{default:a(()=>[o(e,{class:"ele-text-right","wrapper-col":{span:24}},{default:a(()=>[o(d,null,{default:a(()=>[o(s,{type:"primary",onClick:f},{default:a(()=>[ae]),_:1}),o(s,{onClick:_},{default:a(()=>[se]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}},re={class:"ele-body"},le=x("span",null,"\u4E0A\u4F20",-1),ie=x("span",null,"\u5220\u9664",-1),ce=["href"],me=["href"],ue=x("a",{class:"ele-text-danger"},"\u5220\u9664",-1),_e={name:"SystemFile"},qe=Object.assign(_e,{setup(N){const c=b(null),n=b([{key:"index",width:48,align:"center",fixed:"left",hideInSetting:!0,customRender:({index:e})=>{var t,s;return e+((s=(t=c.value)==null?void 0:t.tableIndex)!=null?s:0)}},{title:"\u6587\u4EF6\u540D\u79F0",dataIndex:"name",sorter:!0,showSorterTooltip:!1,ellipsis:!0},{title:"\u6587\u4EF6\u8DEF\u5F84",key:"path",dataIndex:"path",sorter:!0,showSorterTooltip:!1,ellipsis:!0},{title:"\u6587\u4EF6\u5927\u5C0F",dataIndex:"length",sorter:!0,showSorterTooltip:!1,ellipsis:!0,customRender:({text:e})=>e<1024?e+"B":e<1024*1024?(e/1024).toFixed(1)+"KB":e<1024*1024*1024?(e/1024/1024).toFixed(1)+"M":(e/1024/1024/1024).toFixed(1)+"G",width:120},{title:"\u4E0A\u4F20\u4EBA",dataIndex:"createNickname",sorter:!0,showSorterTooltip:!1,ellipsis:!0,width:120},{title:"\u4E0A\u4F20\u65F6\u95F4",dataIndex:"createTime",sorter:!0,showSorterTooltip:!1,ellipsis:!0,customRender:({text:e})=>E(e),width:160},{title:"\u64CD\u4F5C",key:"action",width:120,align:"center"}]),m=b([]),f=({page:e,limit:t,where:s,orders:d})=>X({...s,...d,page:e,limit:t}),_=e=>{var t;m.value=[],(t=c==null?void 0:c.value)==null||t.reload({page:1,where:e})},F=e=>{const t=w("\u8BF7\u6C42\u4E2D..",0);Y(e.id).then(s=>{t(),l.success(s),_()}).catch(s=>{t(),l.error(s.message)})},r=()=>{if(!m.value.length){l.error("\u8BF7\u81F3\u5C11\u9009\u62E9\u4E00\u6761\u6570\u636E");return}q.confirm({title:"\u63D0\u793A",content:"\u786E\u5B9A\u8981\u5220\u9664\u9009\u4E2D\u7684\u6587\u4EF6\u5417?",icon:o(A),maskClosable:!0,onOk:()=>{const e=w("\u8BF7\u6C42\u4E2D..",0);Z(m.value.map(t=>t.id)).then(t=>{e(),l.success(t),_()}).catch(t=>{e(),l.error(t.message)})}})},p=({file:e})=>{if(e.size/1024/1024>100)return l.error("\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7 100MB"),!1;const t=w({content:"\u4E0A\u4F20\u4E2D..",duration:0,mask:!0});return ee(e).then(()=>{t(),l.success("\u4E0A\u4F20\u6210\u529F"),_()}).catch(s=>{t(),l.error(s.message)}),!1};return(e,t)=>{const s=T,d=W,h=I,y=G,u=Q,U=J,D=H;return k(),C("div",re,[o(D,{bordered:!1},{default:a(()=>[o(ne,{onSearch:_}),o(U,{ref_key:"tableRef",ref:c,"row-key":"id",columns:n.value,datasource:f,selection:m.value,"onUpdate:selection":t[0]||(t[0]=g=>m.value=g),scroll:{x:800},"cache-key":"proSystemFileTable"},{toolbar:a(()=>[o(h,null,{default:a(()=>[o(d,{"show-upload-list":!1,customRequest:p},{default:a(()=>[o(s,{type:"primary",class:"ele-btn-icon"},{icon:a(()=>[o(i(te))]),default:a(()=>[le]),_:1})]),_:1}),o(s,{danger:"",type:"primary",class:"ele-btn-icon",onClick:r},{icon:a(()=>[o(i(oe))]),default:a(()=>[ie]),_:1})]),_:1})]),bodyCell:a(({column:g,record:v})=>[g.key==="path"?(k(),C("a",{key:0,href:v.url,target:"_blank"},P(v.path),9,ce)):g.key==="action"?(k(),S(h,{key:1},{default:a(()=>[x("a",{href:v.downloadUrl,target:"_blank"},"\u4E0B\u8F7D",8,me),o(y,{type:"vertical"}),o(u,{placement:"topRight",title:"\u786E\u5B9A\u8981\u5220\u9664\u6B64\u6587\u4EF6\u5417\uFF1F",onConfirm:pe=>F(v)},{default:a(()=>[ue]),_:2},1032,["onConfirm"])]),_:2},1024)):z("",!0)]),_:1},8,["columns","selection"])]),_:1})])}}});export{qe as default};
