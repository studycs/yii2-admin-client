import{cH as Ae,cI as $e,r as x,a as fe,J as t,aa as he,aq as ye,aL as Le,z as T,q as ue,I as c,av as be,aw as Ne,S as le,a9 as B,a0 as Fe,bR as We,b as u,F as _e,ag as Ye,a6 as Ke,cJ as Ze,Y as ne,bi as re,ab as De,aW as Xe,cK as He,ap as Se,P as qe,L as Be,V as Je,bL as Qe,bM as er,v as Oe,cL as Me,by as rr,cw as nr}from"./index.b0e1550a.js";import{a as ar,g as Re}from"./css.1dd79e5e.js";import{R as tr,a as ir,Z as or,b as lr}from"./ZoomOutOutlined.19b0b6ba.js";var ur="[object Number]";function sr(o){return typeof o=="number"||Ae(o)&&$e(o)==ur}function vr(o){var e=x(null),l=fe(t({},o)),r=x([]),i=function(g){e.value===null&&(r.value=[],e.value=ye(function(){var d;r.value.forEach(function(_){d=t(t({},d),_)}),Le(l,d),e.value=null})),r.value.push(g)};return he(function(){e.value&&ye.cancel(e.value)}),[l,i]}function ke(o,e,l,r){var i=e+l,a=(l-r)/2;if(l>r){if(e>0)return T({},o,a);if(e<0&&i<r)return T({},o,-a)}else if(e<0||i>r)return T({},o,e<0?a:-a);return{}}function cr(o,e,l,r){var i=ar(),a=i.width,g=i.height,d=null;return o<=a&&e<=g?d={x:0,y:0}:(o>a||e>g)&&(d=t(t({},ke("x",l,o,a)),ke("y",r,e,g))),d}var Ie=Symbol("previewGroupContext"),xe={provide:function(e){Ye(Ie,e)},inject:function(){return Ke(Ie,{isPreviewGroup:x(!1),previewUrls:c(function(){return new Map}),setPreviewUrls:function(){},current:x(null),setCurrent:function(){},setShowPreview:function(){},setMousePosition:function(){},registerImage:null,rootClassName:""})}},fr=ue({compatConfig:{MODE:3},name:"PreviewGroup",inheritAttrs:!1,props:{previewPrefixCls:String,preview:{type:[Boolean,Object],default:!0},icons:{type:Object,default:function(){return{}}}},setup:function(e,l){var r=l.slots,i=c(function(){var f={visible:void 0,onVisibleChange:function(){},getContainer:void 0,current:0};return be(e.preview)==="object"?ze(e.preview,f):f}),a=fe(new Map),g=x(),d=c(function(){return i.value.visible}),_=c(function(){return i.value.getContainer}),A=function(s,k){var p,b;(p=(b=i.value).onVisibleChange)===null||p===void 0||p.call(b,s,k)},P=Ne(!!d.value,{value:d,onChange:A}),S=le(P,2),j=S[0],w=S[1],I=x(null),K=c(function(){return d.value!==void 0}),$=c(function(){return Array.from(a.keys())}),M=c(function(){return $.value[i.value.current]}),h=c(function(){return new Map(Array.from(a).filter(function(f){var s=le(f,2),k=s[1].canPreview;return!!k}).map(function(f){var s=le(f,2),k=s[0],p=s[1].url;return[k,p]}))}),F=function(s,k){var p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;a.set(s,{url:k,canPreview:p})},L=function(s){g.value=s},y=function(s){I.value=s},N=function(s,k){var p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,b=function(){a.delete(s)};return a.set(s,{url:k,canPreview:p}),b},W=function(s){s==null||s.stopPropagation(),w(!1),y(null)};return B(M,function(f){L(f)},{immediate:!0,flush:"post"}),Fe(function(){j.value&&K.value&&L(M.value)},{flush:"post"}),xe.provide({isPreviewGroup:x(!0),previewUrls:h,setPreviewUrls:F,current:g,setCurrent:L,setShowPreview:w,setMousePosition:y,registerImage:N}),function(){var f=Le({},(We(i.value),i.value));return u(_e,null,[r.default&&r.default(),u(je,t(t({},f),{},{"ria-hidden":!j.value,visible:j.value,prefixCls:e.previewPrefixCls,onClose:W,mousePosition:I.value,src:h.value.get(g.value),icons:e.icons,getContainer:_.value}),null)])}}});const Ge=fr;var H={x:0,y:0},mr=t(t({},Ze()),{},{src:String,alt:String,rootClassName:String,icons:{type:Object,default:function(){return{}}}}),dr=ue({compatConfig:{MODE:3},name:"Preview",inheritAttrs:!1,props:mr,emits:["close","afterClose"],setup:function(e,l){var r=l.emit,i=l.attrs,a=fe(e.icons),g=a.rotateLeft,d=a.rotateRight,_=a.zoomIn,A=a.zoomOut,P=a.close,S=a.left,j=a.right,w=x(1),I=x(0),K=vr(H),$=le(K,2),M=$[0],h=$[1],F=function(){return r("close")},L=x(),y=fe({originX:0,originY:0,deltaX:0,deltaY:0}),N=x(!1),W=xe.inject(),f=W.previewUrls,s=W.current,k=W.isPreviewGroup,p=W.setCurrent,b=c(function(){return f.value.size}),U=c(function(){return Array.from(f.value.keys())}),D=c(function(){return U.value.indexOf(s.value)}),me=c(function(){return k.value?f.value.get(s.value):e.src}),ae=c(function(){return k.value&&b.value>1}),E=x({wheelDirection:0}),J=function(){w.value=1,I.value=0,h(H),r("afterClose")},te=function(){w.value++,h(H)},m=function(){w.value>1&&w.value--,h(H)},C=function(){I.value+=90},R=function(){I.value-=90},G=function(n){n.preventDefault(),n.stopPropagation(),D.value>0&&p(U.value[D.value-1])},V=function(n){n.preventDefault(),n.stopPropagation(),D.value<b.value-1&&p(U.value[D.value+1])},de=ne(T({},"".concat(e.prefixCls,"-moving"),N.value)),se="".concat(e.prefixCls,"-operations-operation"),we="".concat(e.prefixCls,"-operations-icon"),ve=[{icon:P,onClick:F,type:"close"},{icon:_,onClick:te,type:"zoomIn"},{icon:A,onClick:m,type:"zoomOut",disabled:c(function(){return w.value===1})},{icon:d,onClick:C,type:"rotateRight"},{icon:g,onClick:R,type:"rotateLeft"}],ce=function(){if(e.visible&&N.value){var n=L.value.offsetWidth*w.value,z=L.value.offsetHeight*w.value,Z=Re(L.value),O=Z.left,X=Z.top,Y=I.value%180!==0;N.value=!1;var Q=cr(Y?z:n,Y?n:z,O,X);Q&&h(t({},Q))}},ge=function(n){n.button===0&&(n.preventDefault(),n.stopPropagation(),y.deltaX=n.pageX-M.x,y.deltaY=n.pageY-M.y,y.originX=M.x,y.originY=M.y,N.value=!0)},ie=function(n){e.visible&&N.value&&h({x:n.pageX-y.deltaX,y:n.pageY-y.deltaY})},pe=function(n){if(!!e.visible){n.preventDefault();var z=n.deltaY;E.value={wheelDirection:z}}},Ce=function(n){!e.visible||!ae.value||(n.preventDefault(),n.keyCode===Se.LEFT?D.value>0&&p(U.value[D.value-1]):n.keyCode===Se.RIGHT&&D.value<b.value-1&&p(U.value[D.value+1]))},Pe=function(){e.visible&&(w.value!==1&&(w.value=1),(M.x!==H.x||M.y!==H.y)&&h(H))},oe=function(){};return he(function(){B([function(){return e.visible},N],function(){oe();var v,n,z=re(window,"mouseup",ce,!1),Z=re(window,"mousemove",ie,!1),O=re(window,"wheel",pe,{passive:!1}),X=re(window,"keydown",Ce,!1);try{window.top!==window.self&&(v=re(window.top,"mouseup",ce,!1),n=re(window.top,"mousemove",ie,!1))}catch(Y){}oe=function(){z.remove(),Z.remove(),O.remove(),X.remove(),v&&v.remove(),n&&n.remove()}},{flush:"post",immediate:!0}),B([E],function(){var v=E.value.wheelDirection;v>0?m():v<0&&te()})}),De(function(){oe()}),function(){var v=e.visible,n=e.prefixCls,z=e.rootClassName;return u(He,t(t({},i),{},{transitionName:"zoom",maskTransitionName:"fade",closable:!1,keyboard:!0,prefixCls:n,onClose:F,afterClose:J,visible:v,wrapClassName:de,rootClassName:z,getContainer:e.getContainer}),{default:function(){return[u("ul",{class:"".concat(e.prefixCls,"-operations")},[ve.map(function(O){var X=O.icon,Y=O.onClick,Q=O.type,ee=O.disabled;return u("li",{class:ne(se,T({},"".concat(e.prefixCls,"-operations-operation-disabled"),ee&&(ee==null?void 0:ee.value))),onClick:Y,key:Q},[Xe(X,{class:we})])})]),u("div",{class:"".concat(e.prefixCls,"-img-wrapper"),style:{transform:"translate3d(".concat(M.x,"px, ").concat(M.y,"px, 0)")}},[u("img",{onMousedown:ge,onDblclick:Pe,ref:L,class:"".concat(e.prefixCls,"-img"),src:me.value,alt:e.alt,style:{transform:"scale3d(".concat(w.value,", ").concat(w.value,", 1) rotate(").concat(I.value,"deg)")}},null)]),ae.value&&u("div",{class:ne("".concat(e.prefixCls,"-switch-left"),T({},"".concat(e.prefixCls,"-switch-left-disabled"),D.value<=0)),onClick:G},[S]),ae.value&&u("div",{class:ne("".concat(e.prefixCls,"-switch-right"),T({},"".concat(e.prefixCls,"-switch-right-disabled"),D.value>=b.value-1)),onClick:V},[j])]}})}}});const je=dr;var wr=["icons","maskClassName","src"],Ve=function(){return{src:String,wrapperClassName:String,wrapperStyle:{type:Object,default:void 0},rootClassName:String,prefixCls:String,previewPrefixCls:String,previewMask:{type:[Boolean,Function],default:void 0},placeholder:qe.any,fallback:String,preview:{type:[Boolean,Object],default:!0},onClick:{type:Function},onError:{type:Function}}},ze=function(e,l){var r=t({},e);return Object.keys(l).forEach(function(i){e[i]===void 0&&(r[i]=l[i])}),r},gr=0,Ue=ue({compatConfig:{MODE:3},name:"Image",inheritAttrs:!1,props:Ve(),emits:["click","error"],setup:function(e,l){var r=l.attrs,i=l.slots,a=l.emit,g=c(function(){return e.prefixCls}),d=c(function(){return"".concat(g.value,"-preview")}),_=c(function(){var m={visible:void 0,onVisibleChange:function(){},getContainer:void 0};return be(e.preview)==="object"?ze(e.preview,m):m}),A=c(function(){return e.placeholder&&e.placeholder!==!0||i.placeholder}),P=c(function(){return _.value.visible}),S=c(function(){return _.value.getContainer}),j=c(function(){return P.value!==void 0}),w=function(C,R){var G,V;(G=(V=_.value).onVisibleChange)===null||G===void 0||G.call(V,C,R)},I=Ne(!!P.value,{value:P,onChange:w}),K=le(I,2),$=K[0],M=K[1];B($,function(m,C){w(m,C)});var h=x(A.value?"loading":"normal");B(function(){return e.src},function(){h.value=A.value?"loading":"normal"});var F=x(null),L=c(function(){return h.value==="error"}),y=xe.inject(),N=y.isPreviewGroup,W=y.setCurrent,f=y.setShowPreview,s=y.setMousePosition,k=y.registerImage,p=x(gr++),b=c(function(){return e.preview&&!L.value}),U=function(){h.value="normal"},D=function(C){h.value="error",a("error",C)},me=function(C){if(!j.value){var R=Re(C.target),G=R.left,V=R.top;N.value?(W(p.value),s({x:G,y:V})):F.value={x:G,y:V}}N.value?f(!0):M(!0),a("click",C)},ae=function(){M(!1),j.value||(F.value=null)},E=x(null);B(function(){return E},function(){h.value==="loading"&&E.value.complete&&(E.value.naturalWidth||E.value.naturalHeight)&&U()});var J=function(){};he(function(){B([function(){return e.src},b],function(){if(J(),!N.value)return function(){};J=k(p.value,e.src,b.value),b.value||J()},{flush:"post",immediate:!0})}),De(J);var te=function(C){return sr(C)?C+"px":C};return function(){var m=e.prefixCls,C=e.wrapperClassName,R=e.fallback,G=e.src,V=e.placeholder,de=e.wrapperStyle,se=e.rootClassName,we=r.width,ve=r.height,ce=r.crossorigin,ge=r.decoding,ie=r.alt,pe=r.sizes,Ce=r.srcset,Pe=r.usemap,oe=r.class,v=r.style,n=_.value,z=n.icons,Z=n.maskClassName,O=n.src,X=Be(n,wr),Y=ne(m,C,se,T({},"".concat(m,"-error"),L.value)),Q=L.value&&R?R:O!=null?O:G,ee={crossorigin:ce,decoding:ge,alt:ie,sizes:pe,srcset:Ce,usemap:Pe,class:ne("".concat(m,"-img"),T({},"".concat(m,"-img-placeholder"),V===!0),oe),style:t({height:ve},v)};return u(_e,null,[u("div",{class:Y,onClick:b.value?me:function(Te){a("click",Te)},style:t({width:te(we),height:te(ve)},de)},[u("img",t(t(t({},ee),L.value&&R?{src:R}:{onLoad:U,onError:D,src:G}),{},{ref:E}),null),h.value==="loading"&&u("div",{"aria-hidden":"true",class:"".concat(m,"-placeholder")},[V||i.placeholder&&i.placeholder()]),i.previewMask&&b.value&&u("div",{class:["".concat(m,"-mask"),Z]},[i.previewMask()])]),!N.value&&b.value&&u(je,t(t({},X),{},{"aria-hidden":!$.value,visible:$.value,prefixCls:d.value,onClose:ae,mousePosition:F.value,src:Q,alt:ie,getContainer:S.value,icons:z,rootClassName:se}),null)])}}});Ue.PreviewGroup=Ge;const pr=Ue;var Ee={rotateLeft:u(tr,null,null),rotateRight:u(ir,null,null),zoomIn:u(or,null,null),zoomOut:u(lr,null,null),close:u(Je,null,null),left:u(Qe,null,null),right:u(er,null,null)},Cr=ue({compatConfig:{MODE:3},name:"AImagePreviewGroup",inheritAttrs:!1,props:{previewPrefixCls:String},setup:function(e,l){var r=l.attrs,i=l.slots,a=Oe("image",e),g=a.getPrefixCls,d=c(function(){return g("image-preview",e.previewPrefixCls)});return function(){return u(Ge,t(t({},t(t({},r),e)),{},{icons:Ee,previewPrefixCls:d.value}),i)}}});const Pr=Cr;var q=ue({name:"AImage",inheritAttrs:!1,props:Ve(),setup:function(e,l){var r=l.slots,i=l.attrs,a=Oe("image",e),g=a.prefixCls,d=a.rootPrefixCls,_=a.configProvider,A=c(function(){var P=e.preview;if(P===!1)return P;var S=be(P)==="object"?P:{};return t(t({icons:Ee},S),{},{transitionName:Me(d.value,"zoom",S.transitionName),maskTransitionName:Me(d.value,"fade",S.maskTransitionName)})});return function(){var P,S=((P=_.locale)===null||P===void 0?void 0:P.Image)||rr.Image,j=function(){return u("div",{class:"".concat(g.value,"-mask-info")},[u(nr,null,null),S==null?void 0:S.preview])},w=e.previewMask,I=w===void 0?r.previewMask||j:w;return u(pr,t(t({},t(t(t({},i),e),{},{prefixCls:g.value})),{},{preview:A.value}),t(t({},r),{},{previewMask:typeof I=="function"?I:null}))}}});q.PreviewGroup=Pr;q.install=function(o){return o.component(q.name,q),o.component(q.PreviewGroup.name,q.PreviewGroup),o};const yr=q;export{yr as _,Pr as a};
