import{s as T,_ as P,r as i,I as E,u as m,a9 as W,o as $,c as q,w as l,b as t,d as x,c0 as H,c1 as G,e as g,m as v,aF as R,g as J,b5 as K,j as M,t as Q,c2 as X}from"./index.b0e1550a.js";import{_ as Y,a as Z,C as ee}from"./index.9a44580e.js";/* empty css              *//* empty css              *//* empty css               *//* empty css               *//* empty css               */import"./index.13ccca11.js";import{i as z}from"./index.a402f9d8.js";import{A as te,a as oe}from"./ArrowDownOutlined.06436922.js";import{T as le,b as ae,c as ne}from"./index.50a7696f.js";import"./vuedraggable.umd.15cba163.js";import"./css.1dd79e5e.js";import"./index.d4371571.js";import"./Spin.83ba1358.js";import"./index.79d1eddb.js";import"./useMaxLevel.2bdcb2e5.js";import"./Group.ef3b103e.js";import"./index.92aa3868.js";import"./RadioButton.4b1c6045.js";import"./CaretUpOutlined.0f21e912.js";import"./iconUtil.035bdc1b.js";async function se(f){const r=await T.get("https://cdn.eleadmin.com/20200610/document.json",{params:f});return r.data.code===0&&r.data.data?r.data.data:Promise.reject(new Error(r.data.message))}async function ie(f){const r=await T.get("https://cdn.eleadmin.com/20200610/archive.json",{params:f});return r.data.code===0&&r.data.data?r.data.data:Promise.reject(new Error(r.data.message))}const re=g("\u4E0A\u79FB"),ue=g("\u4E0B\u79FB"),ce=g("\u8C03\u51FA"),de=g(" \u8C03\u5165"),me={__name:"file-sort",props:{visible:Boolean,documents:Array},emits:["update:visible"],setup(f,{emit:r}){const b=f,S=i([{title:"\u6848\u5377\u9898\u540D",dataIndex:"title",ellipsis:!0},{title:"\u6848\u5377\u6863\u53F7",dataIndex:"piece_no",ellipsis:!0}]),k=i([{title:"\u6587\u4EF6\u9898\u540D",dataIndex:"title",ellipsis:!0},{title:"\u6587\u4EF6\u6863\u53F7",dataIndex:"archive_no",ellipsis:!0}]),a=i([]),c=i(null),h=i(!0),o=i([]),d=i([]),y=E(()=>m(c)?a.value.filter(e=>{var s;return e.piece_no===((s=m(c))==null?void 0:s.piece_no)}):[]),U=E(()=>a.value.filter(e=>!e.piece_no)),p=()=>{if(!o.value.length){v.error("\u8BF7\u9009\u62E9\u4E00\u6761\u6570\u636E");return}if(o.value.length>1){v.error("\u53EA\u80FD\u9009\u62E9\u4E00\u6761\u6570\u636E");return}if(y.value.indexOf(o.value[0])===0)return;const e=a.value.indexOf(o.value[0]),s=a.value[e-1];a.value[e-1]=o.value[0],a.value[e]=s,o.value=[a.value[e-1]]},n=()=>{if(!o.value.length){v.error("\u8BF7\u9009\u62E9\u4E00\u6761\u6570\u636E");return}if(o.value.length>1){v.error("\u53EA\u80FD\u9009\u62E9\u4E00\u6761\u6570\u636E");return}if(y.value.indexOf(o.value[0])===y.value.length-1)return;const e=a.value.indexOf(o.value[0]),s=a.value[e+1];a.value[e+1]=o.value[0],a.value[e]=s,o.value=[a.value[e+1]]},_=()=>{if(!o.value.length){v.error("\u8BF7\u81F3\u5C11\u9009\u62E9\u4E00\u6761\u6570\u636E");return}o.value.forEach(e=>{e.piece_no=""}),o.value=[]},w=()=>{if(!!m(c)){if(!d.value.length){v.error("\u8BF7\u81F3\u5C11\u9009\u62E9\u4E00\u6761\u6570\u636E");return}d.value.forEach(e=>{var s;e.piece_no=(s=m(c))==null?void 0:s.piece_no}),d.value=[]}},u=()=>{const e=a.value.map(s=>({archive_no:s.archive_no,piece_no:s.piece_no}));console.log(e),v.success("\u8C03\u6574\u6210\u529F"),I()},I=()=>{a.value=[],o.value=[],d.value=[],C(!1)},C=e=>{r("update:visible",e)},A=e=>{c.value=e,o.value=[]},N=()=>{h.value=!0,ie({piece_no_in:b.documents.map(e=>e.piece_no)}).then(e=>{h.value=!1,a.value=e,c.value=b.documents[0]}).catch(e=>{h.value=!1,v.error(e.message)})};return W(()=>b.documents,e=>{e.length&&N()}),(e,s)=>{const j=z,B=Y,O=R,F=J,V=Z,L=K;return $(),q(L,{width:1200,visible:f.visible,title:"\u5377\u5185\u6587\u4EF6\u8C03\u6574","body-style":{padding:"16px 16px 0 16px"},"onUpdate:visible":C,onCancel:I,onOk:u},{default:l(()=>[t(V,{gutter:16},{default:l(()=>[t(B,{lg:8,md:24,sm:24,xs:24},{default:l(()=>[t(j,{bordered:"",size:"small",toolkit:[],height:"360px",current:c.value,"need-page":!1,"row-key":"piece_no","sub-title":"\u6848\u5377\u5217\u8868",columns:S.value,"tools-theme":"default",datasource:f.documents,scroll:{x:280},"selection-type":"radio","row-selection":{columnWidth:38},"tool-style":{padding:"7px 14px"},class:"demo-file-sort-table",style:{"margin-bottom":"16px"},"onUpdate:current":A},null,8,["current","columns","datasource"])]),_:1}),t(B,{lg:8,md:24,sm:24,xs:24},{default:l(()=>[t(j,{bordered:"",size:"small",toolkit:[],height:"360px","need-page":!1,loading:h.value,"sub-title":"\u5377\u5185\u5217\u8868",datasource:m(y),columns:k.value,"row-key":"archive_no","tools-theme":"default",scroll:{x:280},selection:o.value,"onUpdate:selection":s[0]||(s[0]=D=>o.value=D),"row-selection":{columnWidth:38},class:"demo-file-sort-table",style:{"margin-bottom":"16px"}},{toolkit:l(()=>[t(F,null,{default:l(()=>[t(O,{ghost:"",type:"primary",class:"ele-btn-icon",onClick:p},{default:l(()=>[x("span",null,[t(m(te)),re])]),_:1}),t(O,{ghost:"",type:"primary",class:"ele-btn-icon",onClick:n},{default:l(()=>[x("span",null,[t(m(oe)),ue])]),_:1}),t(O,{ghost:"",type:"primary",class:"ele-btn-icon",onClick:_},{default:l(()=>[x("span",null,[ce,t(m(H))])]),_:1})]),_:1})]),_:1},8,["loading","datasource","columns","selection"])]),_:1}),t(B,{lg:8,md:24,sm:24,xs:24},{default:l(()=>[t(j,{bordered:"",size:"small",toolkit:[],height:"360px","need-page":!1,loading:h.value,datasource:m(U),columns:k.value,"sub-title":"\u672A\u5F52\u6863\u5217\u8868","row-key":"archive_no","tools-theme":"default",scroll:{x:280},selection:d.value,"onUpdate:selection":s[1]||(s[1]=D=>d.value=D),"row-selection":{columnWidth:38},class:"demo-file-sort-table",style:{"margin-bottom":"16px"}},{toolkit:l(()=>[t(O,{ghost:"",type:"primary",class:"ele-btn-icon",onClick:w},{default:l(()=>[x("span",null,[t(m(G)),de])]),_:1})]),_:1},8,["loading","datasource","columns","selection"])]),_:1})]),_:1})]),_:1},8,["visible"])}}},pe=P(me,[["__scopeId","data-v-224ae014"]]),_e={class:"ele-body"},ve=g(" \u5377\u5185\u6587\u4EF6\u8C03\u6574 "),fe=x("span",null,[g("\u2003\u9AD8\u5EA6\u94FA\u6EE1"),x("s"),x("s")],-1),he=g("\u5408\u8BA1"),ge={name:"ExampleDocument"},Le=Object.assign(ge,{setup(f){const r=i(null),b=i([]),S=({page:p,limit:n})=>se({page:p,limit:n}),k=i([{key:"index",width:48,align:"center",fixed:"left",hideInSetting:!0,customRender:({index:p})=>{var n,_;return p+((_=(n=r.value)==null?void 0:n.tableIndex)!=null?_:0)}},{title:"\u6848\u5377\u6863\u53F7",dataIndex:"piece_no",ellipsis:!0},{title:"\u6848\u5377\u9898\u540D",dataIndex:"title",ellipsis:!0},{title:"\u5E74\u5EA6",dataIndex:"year",width:100,ellipsis:!0},{title:"\u4FDD\u7BA1\u671F\u9650",dataIndex:"retention",width:120,ellipsis:!0},{title:"\u5BC6\u7EA7",dataIndex:"secret",width:100,ellipsis:!0},{title:"\u6863\u6848\u7C7B\u522B",dataIndex:"type",ellipsis:!0},{title:"\u8F7D\u4F53\u89C4\u683C",dataIndex:"carrier",width:120,ellipsis:!0},{title:"\u4EF6\u6570",dataIndex:"amount",ellipsis:!0}]),a=i([]),c=i(!1),h=i([]),o=i(0),d=i(!1),y=p=>{b.value=p.data,o.value=p.data.map(n=>Number(n.amount)).reduce((n,_)=>{const w=Number(_);return isNaN(w)?n:n+_},0)},U=()=>{if(a.value.length<2){v.error("\u8BF7\u81F3\u5C11\u9009\u62E9\u4E24\u6761\u6570\u636E");return}h.value=b.value.slice(0,3),c.value=!0};return(p,n)=>{const _=R,w=X,u=le,I=ae,C=ne,A=z,N=ee;return $(),M("div",_e,[t(N,{bordered:!1,"body-style":{padding:"10px 20px"}},{default:l(()=>[t(A,{ref_key:"tableRef",ref:r,"row-key":"piece_no",columns:k.value,datasource:S,selection:a.value,"onUpdate:selection":n[1]||(n[1]=e=>a.value=e),scroll:{x:900},height:d.value?"calc(100vh - 420px)":void 0,onDone:y},{toolbar:l(()=>[t(_,{type:"primary",class:"ele-btn-icon",onClick:U},{default:l(()=>[ve]),_:1}),fe,t(w,{checked:d.value,"onUpdate:checked":n[0]||(n[0]=e=>d.value=e),size:"small"},null,8,["checked"])]),summary:l(()=>[t(C,{fixed:""},{default:l(()=>[t(I,null,{default:l(()=>[t(u),t(u),t(u,null,{default:l(()=>[he]),_:1}),t(u),t(u),t(u),t(u),t(u),t(u),t(u,null,{default:l(()=>[g(Q(o.value),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["columns","selection","height"])]),_:1}),t(pe,{visible:c.value,"onUpdate:visible":n[2]||(n[2]=e=>c.value=e),documents:h.value},null,8,["visible","documents"])])}}});export{Le as default};
