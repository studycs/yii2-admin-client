import{cZ as Y,r as c,cj as B,a as I,a9 as N,o as v,c as g,w as s,b as l,u as t,aT as O,e as x,m as b,de as h,df as j,br as M,c5 as z,c$ as E,ck as S,aF as Z,g as A,c6 as G}from"./index.b0e1550a.js";import{D as H}from"./index.aa9f7d32.js";import"./index.764bd5c9.js";import{e as J,p as K,_ as L}from"./role-select.3415dca1.js";import{_ as Q}from"./sex-select.2e22f6ae.js";import{c as W,u as X,a as ee}from"./index.e6a5db54.js";const ae=x("\u5173\u95ED"),le=x(" \u4FDD\u5B58 "),ie={__name:"edit-form",props:{data:Object},setup(w){const p=w,{currentRoute:_,push:y}=Y(),m=c(null),i=c(!1),d=c(!1),{form:a,resetFields:k,assignFields:U}=B({userId:void 0,username:"",nickname:"",sex:void 0,roles:[],email:"",phone:"",password:"",introduction:"",birthday:""}),P=I({username:[{required:!0,type:"string",validator:(o,e)=>new Promise((u,n)=>{if(!e)return n("\u8BF7\u8F93\u5165\u7528\u6237\u8D26\u53F7");W("username",e,a.userId).then(()=>{n("\u8D26\u53F7\u5DF2\u7ECF\u5B58\u5728")}).catch(()=>{u()})}),trigger:"blur"}],nickname:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D",type:"string",trigger:"blur"}],sex:[{required:!0,message:"\u8BF7\u9009\u62E9\u6027\u522B",type:"string",trigger:"blur"}],roles:[{required:!0,message:"\u8BF7\u9009\u62E9\u89D2\u8272",type:"array",trigger:"blur"}],email:[{pattern:J,message:"\u90AE\u7BB1\u683C\u5F0F\u4E0D\u6B63\u786E",type:"string",trigger:"blur"}],password:[{required:!0,type:"string",validator:async(o,e)=>i.value||/^[\S]{5,18}$/.test(e)?Promise.resolve():Promise.reject("\u5BC6\u7801\u5FC5\u987B\u4E3A5-18\u4F4D\u975E\u7A7A\u767D\u5B57\u7B26"),trigger:"blur"}],phone:[{pattern:K,message:"\u624B\u673A\u53F7\u683C\u5F0F\u4E0D\u6B63\u786E",type:"string",trigger:"blur"}]}),D=()=>{!m.value||m.value.validate().then(()=>{d.value=!0,(i.value?X:ee)(a).then(e=>{d.value=!1,b.success(e),q()}).catch(e=>{d.value=!1,b.error(e.message)})}).catch(()=>{})},R=()=>{h({key:t(_).path}),y("/list/basic")},q=()=>{h({key:t(_).path}),j({fullPath:"/list/basic"})};return N(()=>p.data,()=>{var o;p.data?(U({...p.data,password:""}),i.value=!0):(i.value=!1,k(),(o=m.value)==null||o.clearValidate())},{immediate:!0}),(o,e)=>{const u=M,n=z,C=H,F=E,$=S,f=Z,T=A,V=G;return v(),g(V,{ref_key:"formRef",ref:m,model:t(a),rules:P,"label-col":{sm:4,xs:24},"wrapper-col":{sm:20,xs:24},style:{"max-width":"600px",margin:"0 auto"}},{default:s(()=>[l(n,{label:"\u7528\u6237\u8D26\u53F7",name:"username"},{default:s(()=>[l(u,{"allow-clear":"",maxlength:20,placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u8D26\u53F7",value:t(a).username,"onUpdate:value":e[0]||(e[0]=r=>t(a).username=r)},null,8,["value"])]),_:1}),l(n,{label:"\u7528\u6237\u540D",name:"nickname"},{default:s(()=>[l(u,{"allow-clear":"",maxlength:20,placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D",value:t(a).nickname,"onUpdate:value":e[1]||(e[1]=r=>t(a).nickname=r)},null,8,["value"])]),_:1}),l(n,{label:"\u6027\u522B",name:"sex"},{default:s(()=>[l(Q,{value:t(a).sex,"onUpdate:value":e[2]||(e[2]=r=>t(a).sex=r)},null,8,["value"])]),_:1}),l(n,{label:"\u89D2\u8272",name:"roles"},{default:s(()=>[l(L,{value:t(a).roles,"onUpdate:value":e[3]||(e[3]=r=>t(a).roles=r)},null,8,["value"])]),_:1}),l(n,{label:"\u90AE\u7BB1",name:"email"},{default:s(()=>[l(u,{"allow-clear":"",maxlength:100,placeholder:"\u8BF7\u8F93\u5165\u90AE\u7BB1",value:t(a).email,"onUpdate:value":e[4]||(e[4]=r=>t(a).email=r)},null,8,["value"])]),_:1}),l(n,{label:"\u624B\u673A\u53F7",name:"phone"},{default:s(()=>[l(u,{"allow-clear":"",maxlength:11,placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7",value:t(a).phone,"onUpdate:value":e[5]||(e[5]=r=>t(a).phone=r)},null,8,["value"])]),_:1}),l(n,{label:"\u51FA\u751F\u65E5\u671F"},{default:s(()=>[l(C,{class:"ele-fluid",placeholder:"\u8BF7\u9009\u62E9\u51FA\u751F\u65E5\u671F","value-format":"YYYY-MM-DD",value:t(a).birthday,"onUpdate:value":e[6]||(e[6]=r=>t(a).birthday=r)},null,8,["value"])]),_:1}),i.value?O("",!0):(v(),g(n,{key:0,label:"\u767B\u5F55\u5BC6\u7801",name:"password"},{default:s(()=>[l(F,{maxlength:20,value:t(a).password,"onUpdate:value":e[7]||(e[7]=r=>t(a).password=r),placeholder:"\u8BF7\u8F93\u5165\u767B\u5F55\u5BC6\u7801"},null,8,["value"])]),_:1})),l(n,{label:"\u4E2A\u4EBA\u7B80\u4ECB"},{default:s(()=>[l($,{rows:4,maxlength:200,placeholder:"\u8BF7\u8F93\u5165\u4E2A\u4EBA\u7B80\u4ECB",value:t(a).introduction,"onUpdate:value":e[8]||(e[8]=r=>t(a).introduction=r)},null,8,["value"])]),_:1}),l(n,{"wrapper-col":{sm:{offset:4}}},{default:s(()=>[l(T,{size:"middle"},{default:s(()=>[l(f,{onClick:R},{default:s(()=>[ae]),_:1}),l(f,{type:"primary",loading:d.value,onClick:D},{default:s(()=>[le]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["model","rules"])}}};export{ie as _};
