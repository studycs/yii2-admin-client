import{r as B,o as g,c as V,w as c,b as i,e as z,m as N,aF as J,g as M,d as y,j as k,k as j,t as A,F as C,aT as G}from"./index.b0e1550a.js";import{C as T,_ as L,a as H}from"./index.9a44580e.js";/* empty css              *//* empty css              *//* empty css               *//* empty css               *//* empty css               */import{i as K}from"./index.13ccca11.js";import{i as P}from"./index.a402f9d8.js";import{u as E,w as D,r as O}from"./xlsx.db07aefa.js";import{_ as Q}from"./index.1b1a7df7.js";import"./index.7dd997be.js";import"./vuedraggable.umd.15cba163.js";import"./index.50a7696f.js";import"./css.1dd79e5e.js";import"./index.d4371571.js";import"./Spin.83ba1358.js";import"./index.79d1eddb.js";import"./useMaxLevel.2bdcb2e5.js";import"./Group.ef3b103e.js";import"./index.92aa3868.js";import"./RadioButton.4b1c6045.js";import"./CaretUpOutlined.0f21e912.js";import"./iconUtil.035bdc1b.js";import"./DeleteOutlined.e5f00379.js";import"./DownloadOutlined.b6ed2567.js";const W=z(" \u5BFC\u51FA "),X=z(" \u5BFC\u51FA\u5E26\u8868\u5934\u5408\u5E76 "),Y=z(" \u5BFC\u51FA\u9009\u4E2D "),Z={__name:"excel-export",setup(R){const x=B([{key:1,username:"\u5F20\u5C0F\u4E09",amount:18,province:"\u6D59\u6C5F",city:"\u676D\u5DDE",zone:"\u897F\u6E56\u533A",street:"\u897F\u6EAA\u8857\u9053",address:"\u897F\u6EAA\u82B1\u56ED30\u680B1\u5355\u5143"},{key:2,username:"\u674E\u5C0F\u56DB",amount:39,province:"\u6C5F\u82CF",city:"\u82CF\u5DDE",zone:"\u59D1\u82CF\u533A",street:"\u4E1D\u7EF8\u8DEF",address:"\u5929\u5885\u4E4B\u57CE9\u5E622\u5355\u5143"},{key:3,username:"\u738B\u5C0F\u4E94",amount:8,province:"\u6C5F\u897F",city:"\u5357\u660C",zone:"\u9752\u5C71\u6E56\u533A",street:"\u827E\u6EAA\u6E56\u529E\u4E8B\u5904",address:"\u4E2D\u5174\u548C\u56ED1\u5E623\u5355\u5143"},{key:4,username:"\u8D75\u5C0F\u516D",amount:16,province:"\u798F\u5EFA",city:"\u6CC9\u5DDE",zone:"\u4E30\u6CFD\u533A",street:"\u5357\u6D0B\u8857\u9053",address:"\u5357\u6D0B\u67516\u5E621\u5355\u5143"},{key:5,username:"\u5B59\u5C0F\u4E03",amount:12,province:"\u6E56\u5317",city:"\u6B66\u6C49",zone:"\u6B66\u660C\u533A",street:"\u6B66\u660C\u5927\u9053",address:"\u4E24\u6E56\u82B1\u56ED16\u5E622\u5355\u5143"},{key:6,username:"\u5468\u5C0F\u516B",amount:11,province:"\u5B89\u5FBD",city:"\u9EC4\u5C71",zone:"\u9EC4\u5C71\u533A",street:"\u6C64\u53E3\u9547",address:"\u6E29\u6CC9\u675121\u53F7"}]),b=B([{key:"index",width:48,align:"center",fixed:"left",hideInSetting:!0,customRender:({index:a})=>a+1},{title:"\u7528\u6237\u540D",dataIndex:"username",align:"center"},{title:"\u5730\u5740",key:"cityAddress",children:[{title:"\u7701",dataIndex:"province",align:"center"},{title:"\u5E02",dataIndex:"city",align:"center"},{title:"\u533A",dataIndex:"zone",align:"center"},{title:"\u8857\u9053",dataIndex:"street",align:"center"},{title:"\u8BE6\u7EC6\u5730\u5740",dataIndex:"address",align:"center"}]},{title:"\u91D1\u989D",dataIndex:"amount",align:"center"}]),v=B([]),F=()=>{const a=[["\u7528\u6237\u540D","\u7701","\u5E02","\u533A","\u8857\u9053","\u8BE6\u7EC6\u5730\u5740","\u91D1\u989D"]];x.value.forEach(s=>{a.push([s.username,s.province,s.city,s.zone,s.street,s.address,s.amount])});const t="Sheet1",o={SheetNames:[t],Sheets:{}},n=E.aoa_to_sheet(a);o.Sheets[t]=n,n["!cols"]=[{wch:10},{wch:10},{wch:10},{wch:10},{wch:20},{wch:40},{wch:10}],D(o,"\u7528\u6237\u6570\u636E.xlsx")},I=()=>{const a=[["\u7528\u6237\u540D","\u5730\u5740",null,null,null,null,"\u91D1\u989D"],[null,"\u7701","\u5E02","\u533A","\u8857\u9053","\u8BE6\u7EC6\u5730\u5740",null]];x.value.forEach(s=>{a.push([s.username,s.province,s.city,s.zone,s.street,s.address,s.amount])});const t=E.aoa_to_sheet(a);t["!merges"]=[{s:{r:0,c:1},e:{r:0,c:5}},{s:{r:0,c:1},e:{r:0,c:5}},{s:{r:0,c:0},e:{r:1,c:0}},{s:{r:0,c:6},e:{r:1,c:6}}];const o="Sheet1",n={SheetNames:[o],Sheets:{}};n.Sheets[o]=t,D(n,"\u7528\u6237\u6570\u636E.xlsx")},$=()=>{if(v.value.length===0){N.error("\u8BF7\u81F3\u5C11\u9009\u62E9\u4E00\u6761\u6570\u636E");return}const a=[["\u7528\u6237\u540D","\u7701","\u5E02","\u533A","\u8857\u9053","\u8BE6\u7EC6\u5730\u5740","\u91D1\u989D"]];v.value.forEach(n=>{a.push([n.username,n.province,n.city,n.zone,n.street,n.address,n.amount])});const t="Sheet1",o={SheetNames:[t],Sheets:{}};o.Sheets[t]=E.aoa_to_sheet(a),D(o,"\u7528\u6237\u6570\u636E.xlsx")};return(a,t)=>{const o=J,n=M,s=P,d=T;return g(),V(d,{title:"\u5BFC\u51FA Excel",bordered:!1},{default:c(()=>[i(s,{bordered:"","row-key":"key",columns:b.value,datasource:x.value,"need-page":!1,"tools-theme":"default",selection:v.value,"onUpdate:selection":t[0]||(t[0]=w=>v.value=w),toolkit:["size","columns","fullscreen"],scroll:{x:800}},{toolbar:c(()=>[i(n,null,{default:c(()=>[i(o,{type:"primary",class:"ele-btn-icon",onClick:F},{default:c(()=>[W]),_:1}),i(o,{type:"primary",class:"ele-btn-icon",onClick:I},{default:c(()=>[X]),_:1}),i(o,{type:"primary",class:"ele-btn-icon",onClick:$},{default:c(()=>[Y]),_:1})]),_:1})]),_:1},8,["columns","datasource","selection"])]),_:1})}}},q=z("\u5BFC\u5165"),ee=z("\u5BFC\u5165\u62C6\u5206\u5408\u5E76"),te=z("\u5BFC\u5165\u4FDD\u6301\u5408\u5E76"),oe={style:{overflow:"auto"}},se={class:"ele-table ele-table-border",style:{"min-width":"max-content"}},ne=y("th",null,null,-1),re={style:{"text-align":"center"}},ae=["colspan","rowspan"],le=y("div",{style:{margin:"16px 0"}},"\u4E8C\u7EF4\u6570\u7EC4\u683C\u5F0F\u6570\u636E:",-1),ce={style:{"max-height":"300px",padding:"16px",overflow:"auto"}},ie=y("div",{style:{margin:"16px 0"}},"JSON\u683C\u5F0F\u6570\u636E:",-1),_e={style:{"max-height":"300px",padding:"16px",overflow:"auto"}},pe={__name:"excel-import",setup(R){const x=B(["A","B","C","D","E","F","G"]),b=B([]),v=B([]),F=t=>{if(!["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(t.type))return N.error("\u53EA\u80FD\u9009\u62E9 excel \u6587\u4EF6"),!1;if(t.size/1024/1024>20)return N.error("\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7 20MB"),!1;const o=new FileReader;return o.onload=n=>{var p;const s=new Uint8Array((p=n.target)==null?void 0:p.result),d=O(s,{type:"array"}),w=d.SheetNames,m=d.Sheets[w[0]],h=E.sheet_to_json(m,{header:1});let u=[],l=0,f=[];h.forEach(e=>{e.length>l&&(l=e.length);const _={};for(let r=0;r<e.length;r++){const S=a(r);_[S]=e[r],_["__colspan__"+S]=1,_["__rowspan__"+S]=1}u.push(_)});for(let e=0;e<l;e++)f.push(a(e));x.value=f,b.value=u,v.value=h},o.readAsArrayBuffer(t),!1},I=t=>{if(!["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(t.type))return N.error("\u53EA\u80FD\u9009\u62E9 excel \u6587\u4EF6"),!1;if(t.size/1024/1024>20)return N.error("\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7 20MB"),!1;const o=new FileReader;return o.onload=n=>{var p;const s=new Uint8Array((p=n.target)==null?void 0:p.result),d=O(s,{type:"array"}),w=d.SheetNames,m=d.Sheets[w[0]],h=E.sheet_to_json(m,{header:1});m["!merges"]&&m["!merges"].forEach(e=>{for(let _=e.s.r;_<=e.e.r;_++)for(let r=e.s.c;r<=e.e.c;r++)h[_][r]=h[e.s.r][e.s.c]});let u=[],l=0,f=[];h.forEach(e=>{e.length>l&&(l=e.length);const _={};for(let r=0;r<e.length;r++)_[a(r)]=e[r];u.push(_)});for(let e=0;e<l;e++)f.push(a(e));x.value=f,b.value=u,v.value=h},o.readAsArrayBuffer(t),!1},$=t=>{if(!["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(t.type))return N.error("\u53EA\u80FD\u9009\u62E9 excel \u6587\u4EF6"),!1;if(t.size/1024/1024>20)return N.error("\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7 20MB"),!1;const o=new FileReader;return o.onload=n=>{var p;const s=new Uint8Array((p=n.target)==null?void 0:p.result),d=O(s,{type:"array"}),w=d.SheetNames,m=d.Sheets[w[0]],h=E.sheet_to_json(m,{header:1});let u=[],l=0,f=[];h.forEach(e=>{e.length>l&&(l=e.length);const _={};for(let r=0;r<e.length;r++)_[a(r)]=e[r];u.push(_)});for(let e=0;e<l;e++)f.push(a(e));m["!merges"]&&m["!merges"].forEach(e=>{for(let r=e.s.r;r<=e.e.r;r++)for(let S=e.s.c;S<=e.e.c;S++){const U=a(S);u[r]["__colspan__"+U]=0,u[r]["__rowspan__"+U]=0}const _=a(e.s.c);u[e.s.r]["__colspan__"+_]=e.e.c-e.s.c+1,u[e.s.r]["__rowspan__"+_]=e.e.r-e.s.r+1}),x.value=f,b.value=u,v.value=h},o.readAsArrayBuffer(t),!1},a=t=>{const o=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];if(t<o.length)return o[t];const n=parseInt(String(t/o.length)),s=t%o.length;return o[n]+o[s]};return(t,o)=>{const n=J,s=Q,d=M,w=K,m=L,h=H,u=T;return g(),V(u,{title:"\u5BFC\u5165 Excel",bordered:!1},{default:c(()=>[i(w,{tools:[]},{default:c(()=>[i(d,null,{default:c(()=>[i(s,{"before-upload":F,"show-upload-list":!1,accept:".xls,.xlsx"},{default:c(()=>[i(n,{type:"primary",class:"ele-btn-icon"},{default:c(()=>[q]),_:1})]),_:1}),i(s,{"before-upload":I,"show-upload-list":!1,accept:".xls,.xlsx"},{default:c(()=>[i(n,{type:"primary",class:"ele-btn-icon"},{default:c(()=>[ee]),_:1})]),_:1}),i(s,{"before-upload":$,"show-upload-list":!1,accept:".xls,.xlsx"},{default:c(()=>[i(n,{type:"primary",class:"ele-btn-icon"},{default:c(()=>[te]),_:1})]),_:1})]),_:1})]),_:1}),y("div",oe,[y("table",se,[y("thead",null,[y("tr",null,[ne,(g(!0),k(C,null,j(x.value,l=>(g(),k("th",{key:l,style:{"text-align":"center"}},A(l),1))),128))])]),y("tbody",null,[(g(!0),k(C,null,j(b.value,(l,f)=>(g(),k("tr",{key:f},[y("td",re,A(f+1),1),(g(!0),k(C,null,j(x.value,p=>(g(),k(C,null,[l["__colspan__"+p]!==0&&l["__rowspan__"+p]!==0?(g(),k("td",{key:p,colspan:l["__colspan__"+p],rowspan:l["__rowspan__"+p],style:{"text-align":"center"}},A(l[p]),9,ae)):G("",!0)],64))),256))]))),128))])])]),i(h,{gutter:32},{default:c(()=>[i(m,{md:12,xs:24},{default:c(()=>[le,y("pre",ce,A(JSON.stringify(v.value,null,4))+`\r
          `,1)]),_:1}),i(m,{md:12,xs:24},{default:c(()=>[ie,y("pre",_e,A(JSON.stringify(b.value,null,4))+`\r
          `,1)]),_:1})]),_:1})]),_:1})}}},ue={class:"ele-body ele-body-card"},de={name:"ExtensionExcel"},Je=Object.assign(de,{setup(R){return(x,b)=>(g(),k("div",ue,[i(Z),i(pe)]))}});export{Je as default};
